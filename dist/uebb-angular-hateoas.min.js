angular.module("uebb.hateoas.templates",[]).run(["$templateCache",function(e){e.put("uebb_hateoas_templates/hateoas-link.html",'<div>\n    <div ng-show="promise.isFulfilled()" class="transclude-content"></div>\n\n    <div ng-if="!disableSpinner && (!promise || promise.isPending())">\n        <span class="fa fa-spinner fa-spin"></span> {{ labelPrefix + \'.loading\' }}\n    </div>\n\n    <div ng-if="promise.isRejected()">\n        {{ labelPrefix + \'.error\' }}\n    </div>\n\n\n</div>'),e.put("uebb_hateoas_templates/hateoas-list.html",'<div ng-show="if !== false" class="hateoas-list">\n\n	<div ng-show="orderFields" class="element-spacing-small">\n		{{ \'general.list.order.label\' | translate }} &nbsp;&nbsp;&nbsp;\n		<div class="btn-group">\n			<a href data-toggle="dropdown" class="btn btn-link dropdown-toggle">\n				<i class="fa fa-fw fa-sort"></i>{{ labelPrefix + \'.field.\' + orderField | translate }} <span class="caret"></span>\n			</a>\n			<ul class="dropdown-menu" role="menu">\n				<li ng-repeat="field in orderFields" ng-class="{\'active\': orderField == field}">\n					<a dropdown-toggle href ng-click="setOrder(field, orderDirection)"><i class="fa fa-fw fa-sort"></i>{{ labelPrefix + \'.field.\' + field | translate }} </a>\n				</li>\n			</ul>\n		</div>\n		<div class="btn-group">\n			<a href data-toggle="dropdown" class="btn btn-link dropdown-toggle">\n				<i class="fa fa-fw" ng-class="{\'fa-sort-amount-asc\': orderDirection == \'ASC\', \'fa-sort-amount-desc\': orderDirection == \'DESC\'}"></i>{{ \'general.list.direction.\' + orderDirection | translate }} <span class="caret"></span>\n			</a>\n			<ul class="dropdown-menu" role="menu">\n				<li ng-class="{\'active\': orderDirection == \'ASC\'}">\n					<a dropdown-toggle href ng-click="setOrder(orderField, \'ASC\')"><i class="fa fa-fw fa-sort-amount-asc"></i>{{ \'general.list.order.direction.ASC\' | translate }}</a>\n				</li>\n				<li ng-class="{\'active\': orderDirection == \'DESC\'}">\n					<a dropdown-toggle href ng-click="setOrder(orderField, \'DESC\')"><i class="fa fa-fw fa-sort-amount-desc"></i>{{ \'general.list.order.direction.DESC\' | translate }}</a>\n				</li>\n			</ul>\n		</div>\n	</div>\n\n\n	<div class="response element-spacing-small" ng-show="!disableMessages">\n\n		<div ng-show="!disableSpinner && (!promise || promise.isPending())">\n			<span class="fa fa-spinner fa-spin"></span> {{ labelPrefix + \'.loading\' | translate }}\n		</div>\n\n		<div ng-show="transcludeScope.error">\n			{{ labelPrefix + \'.error\' | translate }}\n			{{trancludeScope.error}}\n		</div>\n\n		<div ng-show="promise.isResolved() && !transcludeScope.error && transcludeScope[as || rel].length === 0">\n			{{ labelPrefix + \'.empty\' | translate }}\n		</div>\n\n	</div>\n\n	<div ng-show="promise.isResolved() && !transcludeScope.error" class="hateoas-list-items transclude-content"></div>\n\n	<div class="hateoas-pagination">\n		<pagination\n				class="pagination-sm"\n				ng-show="!disablePagination && pages > 1"\n				total-items="pages * limit"\n				items-per-page="limit"\n				ng-model="page"\n				previous-text="&lt;"\n				next-text="&gt;"\n				first-text="&lt;&lt;"\n				last-text="&gt;&gt;"\n				boundary-links="true"\n				max-size="3"\n				rotate="false">\n		</pagination>\n	</div>\n\n</div>\n\n<div ng-show="bare" class="transclude-bare"></div>\n'),e.put("uebb_hateoas_templates/hateoasSelectList.html",'<div class="row">\n	<div class="col-sm-12">\n		<div class="hateoas-select-list-wrap">\n			<div class="row hateoas-select-list">\n				<div class="col-sm-5 selected-items-wrap">\n					<div class="selected-items">\n						<h2>{{ (labelPrefix + \'.selected.header\') | translate }}</h2>\n						<input type="text" ng-model="searchSelected" placeholder="{{ labelPrefix + \'.placeholder.search\' | translate }}" class="form-control" />\n						<hateoas-list resource="resource"\n									  rel="{{ rel }}"\n									  as="items"\n									  update="updateSelected"\n									  search="searchSelected"\n									  label-prefix="{{ labelPrefix }}.selected"\n									  order-field="{{ orderField }}"\n									  order-direction="{{ orderField }}">\n							<table class="table table-border table-hover table-condensed table-striped">\n								<tr ng-if="items.length > 0">\n									<th colspan="2">{{ (labelPrefix + \'.selected.currently_assigned\') | translate }}</th>\n								</tr>\n								<tr ng-repeat="item in items" ng-class="{ removed: inArray(item, removed) }">\n									<td ng-bind="{{ itemLabel }}"></td>\n									<td style="width: 50px;" class="text-center">\n										<a class="btn-pointer"\n										   ng-click="remove(item)"\n										   ng-hide="inArray(item, removed)"\n										   tooltip="{{ \'general.item.remove\' | translate }}"\n										   tooltip-append-to-body="true"><span class="fa fa-trash-o"></span></a>\n										<a class="btn-pointer"\n										   ng-click="undoRemove(item)"\n										   ng-show="inArray(item, removed)"\n										   tooltip="{{ \'general.item.undoRemove\' | translate }}"\n										   tooltip-append-to-body="true"><span class="fa fa-undo"></span></a>\n									</td>\n								</tr>\n\n								<tr ng-if="added.length > 0">\n									<th colspan="2">{{ (labelPrefix + \'.selected.recently_added\') | translate }}</th>\n								</tr>\n								<tr ng-repeat="item in added">\n									<td ng-bind="{{ itemLabel }}"></td>\n									<td style="width: 50px;" class="text-center">\n										<a class="btn-pointer"\n										   ng-click="undoAdd(item)"\n										   tooltip="{{ \'general.item.remove\' | translate }}"\n										   tooltip-append-to-body="true"><span class="fa fa-trash-o"></span></a>\n									</td>\n								</tr>\n							</table>\n						</hateoas-list>\n					</div>\n				</div>\n\n				<div class="col-sm-2 chevron-wrap">\n					<div class="chevron">\n						<span class="fa fa-chevron-left fa-2x hidden-xs"></span>\n						<span class="fa fa-chevron-up fa-2x visible-xs"></span>\n					</div>\n				</div>\n\n				<div class="col-sm-5 available-items">\n					<h2>{{ (labelPrefix + \'.available.header\') | translate }}</h2>\n					<input type="text" ng-model="searchAvailable" placeholder="{{ labelPrefix + \'.placeholder.search\' | translate }}" class="form-control" />\n					<hateoas-list resource="srcResource"\n								  rel="{{ srcRel }}"\n								  as="items"\n								  update="updateAvailable"\n								  search="searchAvailable"\n								  filter="srcFilter"\n								  if="resource"\n								  label-prefix="{{ labelPrefix }}.available"\n								  order-field="{{ orderField }}"\n								  order-direction="{{ orderDirection }}">\n\n						<table class="table table-border table-hover table-condensed table-striped">\n							<tbody>\n								<tr ng-repeat="item in items"\n									ng-hide="inArray(item, added)"\n									ng-click="add(item)"\n									style="cursor: pointer"\n									tooltip="{{ \'general.item.add\' | translate }}"\n									tooltip-append-to-body="true">\n									<td style="width: 20px;" class="text-center">\n										<a class="btn-pointer" ng-click="add(item)"><span class="fa fa-plus"></span></a>\n									</td>\n									<td ng-bind="{{ itemLabel }}"></td>\n								</tr>\n							</tbody>\n						</table>\n					</hateoas-list>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>'),e.put("uebb_hateoas_templates/select-file.html",'<div class="select-file">\n\n        <hateoas-list disable-pagination="true" disable-messages="true" resource="linkResource" limit="0" rel="{{linkRel}}" as="existingFiles" update="data.updateExisting">\n            <div ng-if="existingFiles.length > 0" class="existing-files">\n                <h5>{{ \'file.label.existingFiles\' | translate }}</h5>\n                <ul>\n                    <li ng-repeat="file in existingFiles">\n\n                        {{ file.name }} ({{file.size | filesize}})\n                        <a class="btn-pointer" delete-resource="file" on-delete="data.updateExisting = true" label="linkResource.name">\n                            <i class="fa fa-trash-o" tooltip="{{ \'file.label.delete\' | translate }}"></i>\n                        </a>\n                    </li>\n                </ul>\n            </div>\n        </hateoas-list>\n\n        <div ng-if="files.length > 0" class="new-files">\n            <h5>{{ \'file.label.newFiles\' | translate }}</h5>\n\n            <ul>\n                <li ng-repeat="file in files">\n\n                    <span ng-class="{\'text-danger\' : getFileErrors(file) !== null}">\n                        {{ file[uploadProperty].name }} ({{ file[uploadProperty].size | filesize}})\n                    </span>\n\n            <span ng-if="file.$newVersion">\n                        &nbsp; <span tooltip="{{ \'file.label.newVersion\' | translate }}" tooltip-append-to-body="true" class="btn-help"><i class="fa fa-asterisk"></i></span> &nbsp;\n                    </span>\n\n                    <a title="remove" class="btn-pointer" ng-click="files.splice(files.indexOf(file), 1)">\n                        <i class="fa fa-times" tooltip="{{ \'file.label.delete\' | translate }}"></i>\n                    </a>\n\n                    <div class="help-block" ng-if="getFileErrors(file) !== null">\n                        <ul>\n                            <li ng-repeat="message in getFileErrors(file).uploadedFile.errors" translate="{{ message }}" ></li>\n                        </ul>\n                    </div>\n\n                </li>\n            </ul>\n\n        </div>\n\n        <span class="btn btn-default btn-file">\n\n            {{ label | translate }} <input type="file" accept="{{ mimeTypes }}" />\n        </span>\n</div>'),e.put("uebb_hateoas_templates/select-hateoas.html",'<div class="chosen-container"\n	 style="width:100%"\n	 ng-class="{\'chosen-with-drop\': showDropdown, \'chosen-container-active\': active, \'chosen-container-single\': !multiple, \'chosen-container-multi\': !!multiple, \'chosen-disabled\':disabled}">\n\n	<ul ng-show="multiple" class="chosen-choices">\n		<li ng-repeat="item in selected" class="search-choice">\n			<span ng-bind="{{label}}"></span>\n			<a class="search-choice-close" ng-click="remove(item)"></a>\n		</li>\n		<li class="search-field">\n			<input ng-show="active"\n				   type="text"\n				   ng-model="search"\n				   class="default search"\n				   autocomplete="off"\n				   style="width: 125px;"\n				   ng-change="page=1;showDropdown=true;query()"\n				   ng-keydown="type($event)" />\n			<input ng-hide="active || selected.length > 0" type="text" ng-disabled="disabled" value="{{placeholder}}" class="default" />\n		</li>\n	</ul>\n\n\n	<a ng-show="!multiple" class="chosen-single chosen-default">\n		<span ng-if="selected.length == 0">{{placeholder}}</span>\n		<span ng-if="selected.length" ng-repeat="item in selected" ng-bind="{{label}}">\n		</span>\n\n		<i ng-if="selected.length" ng-click="remove(selected[0])" class="fa fa-times chosen-remove" ng-hide="clearButton === false"></i>\n\n		<div><b></b></div>\n	</a>\n\n	<div class="chosen-drop">\n		<div ng-show="!multiple" class="chosen-search">\n			<input type="text" class="default search" autocomplete="off" ng-model="search" ng-change="page=1;query()">\n		</div>\n		<div ng-if="!request || request.isPending()" class="chosen-spinner" style="padding:20px;text-align:center">\n			<span class="fa fa-spinner fa-spin"></span>\n		</div>\n		<div ng-if="request.isFulfilled()">\n			<div ng-show="request.value().items.length == 0" style="padding:20px;text-align:center">\n				{{ \'general.list.empty\' | translate }}\n				<div ng-show="!!created && !!createFactory && search != \'\'"><a ng-click="create()">"{{search}}" {{ \'general.add\' | translate }}</a></div>\n			</div>\n			<ul class="chosen-results">\n				<li ng-repeat="item in request.value().items" ng-class="{\'active-result\': isNotSelected(item), \'result-selected\': !isNotSelected(item), \'highlighted\': item.selected}" ng-bind="{{label}}" ng-click="add(item)"></li>\n				<li ng-show="displayCreate && request.value().items.length != 0" class="active-result">\n					<a ng-click="create()">"{{search}}" {{ \'general.add\' | translate }}</a>\n				</li>\n			</ul>\n\n			<div class="select-pagination" ng-show="request.value().pages > 1">\n				<div class="pages">\n					{{ \'general.page\' | translate }} <span>{{ page }}</span> {{ \'general.of\' | translate }} <span>{{ request.value().pages }}</span>\n				</div>\n				<div class="pagination"> \n					<ul class="pagination">\n						<li ng-class="{disabled: page <= 1}" class="hateoas-select-prev">\n							<a ng-click="changePage(page - 1);">\n								&laquo;\n							</a>\n						</li>\n						<li ng-class="{disabled: page >= request.value().pages}" class="hateoas-select-next">\n							<a ng-click="changePage(page + 1);">\n								&raquo;\n							</a>\n						</li>\n					</ul>\n				</div>\n			</div>\n\n		</div>\n		<div ng-if="request.isRejected()" style="padding:20px;text-align:center">\n			{{ \'general.list.error\' | translate }}\n		</div>\n\n	</div>\n</div>\n')}]),angular.module("uebb.hateoas",["uebb.hateoas.templates","pascalprecht.translate"]),angular.module("uebb.hateoas").filter("filesize",function(){var e=["bytes","KB","MB","GB","TB","PB"];return function(t,n){if(isNaN(parseFloat(t))||!isFinite(t))return"?";for(var r=0;t>=1024;)t/=1024,r++;return t.toFixed(+n)+" "+e[r]}}),angular.module("uebb.hateoas").factory("HateoasResource",["$http","Promise","hateoasUtil","hateoasCache","HateoasRequestError",function(e,t,n,r,a){"use strict";function i(){this.$originalData={},this.$links={}}i.prototype.setData=function(e){return angular.copy(n.getProperties(e),this),this.$originalData=e,this.$links=n.getLinks(e),t.resolve(this)},i.prototype.getData=function(){var e=n.copy(this);return delete e.$links,delete e.$originalData,e[n.linksProperty]=n.copy(this.$links),e},i.prototype.getLink=function(e,n,r){var a=this.getHref(e);return angular.isArray(a)?t.all(a.map(function(e){return i.get(e,n,r)})):a?i.get(a,n,r):t.reject(new Error("Link not found: "+e))},i.prototype.setLink=function(e,t,n){this.setHref(e,t.getHref("self"),n)},i.prototype.getHref=function(e,t){var r=e.split("/");e=r.shift();var a=r.join("/");return t&&(t=n.flatten(t)),angular.isArray(this.$links[e])?this.$links[e].map(function(e){return n.addParamsToUrl(n.mergeLink(e.href,a),t)}):this.$links[e]?n.addParamsToUrl(n.mergeLink(this.$links[e].href,a),t):null},i.prototype["delete"]=function(){var n=this.getHref("self");return t.resolve(e({method:"DELETE",url:n,headers:s,withCredentials:!0})).then(function(){r.invalidateRelated(this),r.remove(n)}.bind(this),l)},i.prototype.hasLink=function(e,t){return this.hasHref(e,t.getHref("self"))},i.prototype.hasHref=function(e,t){var r=this.getHref(e);if(void 0===t)return angular.isArray(r)?r.length>0:!!r;if(!angular.isArray(r)){var a=r;r=[],a&&r.push(a)}if(0===r.length)return!1;t=n.normalizeUrl(t);for(var i=0;i<r.length;i++)if(t===n.normalizeUrl(r[i]))return!0;return!1},i.prototype.isLinkedWith=function(e){for(var t in this.$links)if(this.$links.hasOwnProperty(t)&&this.hasLink(t,e))return!0;return!1},i.prototype.removeLink=function(e,t,n){return this.removeHref(e,t.getHref("self"),n)},i.prototype.removeHref=function(e,t,r){r&&(angular.isArray(this.$originalData[n.linksProperty][e])?0===this.$originalData[n.linksProperty][e].filter(function(e){return e.href===t}).length&&this.$originalData[n.linksProperty][e].push({href:t}):this.$originalData[n.linksProperty][e]?this.$originalData[n.linksProperty][e].href!==t&&(this.$originalData[n.linksProperty][e]=[this.$originalData[n.linksProperty][e],{href:t}]):this.$originalData[n.linksProperty][e]=[{href:t}]),t===!0&&delete this.$links[e],angular.isArray(this.$links[e])?angular.forEach(this.$links[e],function(n){n.href===t&&this.$links[e].splice(this.$links[e].indexOf(n),1)}.bind(this)):this.$links[e]&&this.$links[e].href===t&&delete this.$links[e]},i.prototype.setHref=function(e,t,n){if(n)this.$links[e]={href:t};else{if(!angular.isArray(this.$links[e])){var r=[];this.$links[e]&&r.push(this.$links[e]),this.$links[e]=r}this.$links[e].push({href:t})}},i.prototype.post=function(r){var a=this.getData(),i=!1,o={method:"POST",url:r,headers:angular.copy(s),data:a,withCredentials:!0};return Object.keys(a).forEach(function(e){a[e]instanceof File&&(i=!0)}),i&&(o.data=n.convertJsonToFormData(a),o.headers["Content-Type"]=void 0,o.transformRequest=function(e){return e}),t.resolve(e(o)).then(function(e){return 201===e.status&&(this.setHref("self",e.headers("Location"),!0),this.id=this.getHref("self").split("/").pop(),this.$originalData=this.getData()),this}.bind(this),l)},i.prototype.getChanges=function(){var e=n.removeVirtualLinks(n.getNormalizedData(this.$originalData)),t=n.removeVirtualLinks(this.getData()),r=e[n.linksProperty],a=t[n.linksProperty],i=function(e){return e.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])},s=i([].concat(Object.keys(e),Object.keys(t)));s.splice(s.indexOf(n.linksProperty),1);var l=[];angular.forEach(s,function(n){JSON.stringify(e[n])!==JSON.stringify(t[n])&&l.push({op:"replace",path:"/"+n,value:t[n]})});var o=i([].concat(Object.keys(e[n.linksProperty]),Object.keys(t[n.linksProperty])));return angular.forEach(o,function(e){var t=[],i=[];angular.isArray(r[e])?t=r[e]:r[e]&&t.push(r[e]),angular.isArray(a[e])?i=a[e]:a[e]&&i.push(a[e]);var s=[];angular.forEach(t,function(e){var t=!1;angular.forEach(i,function(n){e.href===n.href&&(t=!0)}),t||s.push(e)}),s.length&&l.push({op:"remove",path:"/"+n.linksProperty+"/"+e,value:s});var o=[];angular.forEach(i,function(e){var n=!1;angular.forEach(t,function(t){t.href===e.href&&(n=!0)}),n||o.push(e)}),o.length&&l.push({op:"add",path:"/"+n.linksProperty+"/"+e,value:o})}),l},i.prototype.reset=function(){var e=this.$originalData;for(var t in this)this.hasOwnProperty(t)&&delete this[t];this.setData(e)},i.prototype.applyChanges=function(e){angular.forEach(e,function(e){var t=e.path.split("/");if(t.shift(),t[0]===n.linksProperty)switch(e.op){case"add":Array.isArray(e.value)?angular.forEach(e.value,function(e){this.setHref(t[1],e.href)}.bind(this)):this.setHref(t[1],e.value.href,!0);break;case"remove":Array.isArray(e.value)?angular.forEach(e.value,function(e){this.removeHref(t[1],e.href)}.bind(this)):this.removeHref(t[1],e.value.href)}else switch(e.op){case"replace":this[t[0]]=e.value;break;case"remove":delete this[t[0]]}}.bind(this))},i.prototype.reload=function(){return i.get(this.getHref("self"),null,!0)},i.prototype.save=function(e,t){var n;return n=this.getHref("self")?this.patch(t):this.post(e),n.then(function(){r.invalidateMatching(e),r.invalidateMatching(this.getHref("self")),angular.forEach(Object.keys(this.$links),function(e){angular.forEach(angular.isArray(this.$links[e])?this.$links[e]:[this.$links[e]],function(e){r.invalidateMatching(e.href)}.bind(this))}.bind(this))}.bind(this))},i.prototype.patch=function(n){var r=this.getHref("self"),a=this.getChanges();return 0!==a.length||n?t.resolve(e({method:"PATCH",url:r,headers:s,data:a,withCredentials:!0})).then(function(){return this.$originalData=this.getData(),this}.bind(this),l):t.resolve(this)},i.setContentType=function(e,t){r.setContentType(e,t)},r.setContentType("application/vnd.uebb.resource+json",i),r.setDefaultCtor(i),i.get=function(a,i,o){a=n.addParamsToUrl(a,i);var c=r.getCachedPromise(a);if(!(!c||c.isRejected()||o&&c.isResolved()))return c;if(!o&&r.hasValidCache(a))return t.resolve(r.getCached(a));var u=t.defer(),d=e({method:"GET",url:a,headers:s,timeout:u.promise,withCredentials:!0}),f=t.resolve(d).cancellable()["catch"](t.CancellationError,function(e){return u.resolve(),t.reject(e)}).then(function(e){return r.addToCache(e.data,e.headers)}).then(function(e){return r.setCachedRedirect(a,e.getHref("self")),e},l);return r.setCached(a,null,null,f),f},i.clearCache=function(){r.clear()};var s={"Cache-Control":"no-cache",Pragma:"no-cache"};i.setDefaultHeader=function(e,t){null===t?delete s[e]:s[e]=t},i.setlinksProperty=function(e){n.linksProperty=e},i.setembeddedProperty=function(e){n.embeddedProperty=e};var l=function(e){throw new a(e)};return i.setDefaultErrorCallback=function(e){l=e},i.invalidateMatching=function(e){r.invalidateMatching(e)},i}]),angular.module("uebb.hateoas").factory("hateoasCache",["hateoasUtil","Promise",function(e,t){function n(t){return t=e.normalizeUrl(t),x.hasOwnProperty(t)?x[t].resource:null}function r(t,n){return t=e.normalizeUrl(t),x.hasOwnProperty(t)?x[t].headers(n):null}function a(n){return n=e.normalizeUrl(n),x.hasOwnProperty(n)&&x[n].promise instanceof t&&!x[n].promise.isRejected()&&!x[n].invalid?x[n].promise:null}function i(t){t=e.normalizeUrl(t);var n=r(t,"Cache-Control"),a={};return angular.isString(n)&&angular.forEach(n.split(";"),function(e){var t=e.split("=");a[t[0]]=t[1]}),a}function s(t){t=e.normalizeUrl(t);var n=x[t];n&&(n.invalid=!0)}function l(e){try{return new URI(e).search("").hash("").toString()}catch(t){return e}}function o(e){e=l(e),Object.keys(x).forEach(function(t){l(t)===e&&s(t)})}function c(t){if(t=e.normalizeUrl(t),n(t)&&!x[t].invalid){var a=new Date(r("Date")).getTime(),s=i(t),l=parseInt(s["max-age"],10);if(!l||Date.now()-a>l)return!0}return!1}function u(t,n,r,a){t=e.normalizeUrl(t),x[t]=x[t]||{},n&&(x[t].resource=n),r&&(x[t].headers=r),x[t].promise=a,(a||n)&&(x[t].invalid=!1)}function d(t,n){t&&n&&(t=e.normalizeUrl(t),n=e.normalizeUrl(n),t!==n&&(x[t]=x[n]))}function f(e){return function(t){return"content-type"===t.toLowerCase()?"":e(t)}}function p(e){if(!$[e])for(var t in $)$.hasOwnProperty(t)&&e.match(t)&&($[e]=$[t]);return $[e]||P}function h(e,t){var r=p(t("Content-Type"));return g(e,f(t)).then(function(){return(new r).setData(e)}).then(function(e){var r=e.getHref("self");if(r){var a=n(r);if(a){u(r,a,t,null);var i=a.getChanges();return a.setData(e.getData()).then(function(){return a.applyChanges(i),a})}u(r,e,t,null)}return e})}function g(n,r){var a=[];return angular.forEach(Object.keys(n[e.embeddedProperty]||{}),function(t){var i=n[e.embeddedProperty][t];Array.isArray(i)?angular.forEach(i,function(e){a.push(h(e,r))}):a.push(h(i,r))}),t.all(a)}function m(){for(var e in x)x.hasOwnProperty(e)&&delete x[e]}function v(e){delete x[e]}function b(e,t){$[e]=t}function y(e,t){Object.keys(x).forEach(function(n){x[n].resource&&(t?e.isLinkedWith(x[n].resource):x[n].resource.isLinkedWith(e))&&(x[n].invalid=!0)})}function k(e){e=l(e),Object.keys(x).forEach(function(t){if(l(t)===e){var r=n(t);r&&y(r,!0)}})}function w(e){P=e}var P,x={},$={};return{addToCache:h,getCached:n,getCachedHeader:r,getCachedPromise:a,invalidateCache:s,invalidateMatching:o,invalidateRelated:y,invalidateRelatedMatching:k,hasValidCache:c,setCachedRedirect:d,setCached:u,remove:v,clear:m,setContentType:b,setDefaultCtor:w}}]),angular.module("uebb.hateoas").factory("HateoasCollection",["HateoasResource",function(e){function t(){e.apply(this,arguments),this.items=[]}return t.prototype=Object.create(e.prototype),t.prototype.getItems=function(){return this.getLink("items").then(function(e){return this.items=e,this.items}.bind(this))},t.prototype.setData=function(t){return e.prototype.setData.call(this,t).then(function(){return this.getItems()}.bind(this)).then(function(){return this}.bind(this))},t.prototype.getData=function(){var t=e.prototype.getData.call(this);return delete t.items,t},t.prototype.post=t.prototype.patch=function(){throw"Collections cannot be saved"},t.prototype.fetchPage=function(t,n){var r=new URI(this.getHref("self")).removeSearch("page").removeSearch("limit").addSearch("page",t).addSearch("limit",void 0===n?this.limit:n).build();return e.get(r)},t.prototype.nextPage=function(){return e.get(this.getHref("next"))},t.prototype.previousPage=function(){return e.get(this.getHref("previous")||this.getHref("prev"))},t.prototype.query=function(t){return t=t||{},t.page=t.page||1,e.get(this.getHref("self"),t)},t}]),angular.module("uebb.hateoas").factory("HateoasRequestError",function(){function e(t){Error.call(this),angular.isFunction(Error.captureStackTrace)&&Error.captureStackTrace(this,e),this.message="There was an error during a hateoas request",this.code=t.code,this.data=t.data,this.headers=t.headers,this.status=t.status}return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e.prototype.name="HateoasRequestError",e}),angular.module("uebb.hateoas").directive("hateoasLink",["Promise","$timeout","HateoasResource",function(e,t,n){return{restrict:"AEC",templateUrl:"uebb_hateoas_templates/hateoas-link.html",transclude:!0,replace:!1,scope:{resource:"=",rel:"@",as:"@",labelPrefix:"@",disableSpinner:"=?",update:"=?",onLoad:"&",noResetOnRouteChange:"=?",ignoreCache:"&"},link:function(e,t,n,r,a){var i=e.$parent.$new();e.transcludeScope=i,a(i,function(e){t.find(".transclude-content").append(e)})},controller:["$scope",function(t){function r(){e.resolve(t.resource).then(function(e){if(e instanceof n){if(!t.update&&a===e&&i===t.rel)return;var r=t.update||t.ignoreCache();t.update=!1,a=e,i=t.rel,t.transcludeScope.error=null,t.transcludeScope[t.as||t.rel]=null,t.promise&&t.promise.isPending()&&t.promise.cancel(),t.promise=e.getLink(t.rel,null,r).then(function(e){var n={};t.transcludeScope[t.as||t.rel]=n[t.as||t.rel]=e,t.onLoad(n)},function(e){t.transcludeScope.error=e})["finally"](function(){t.update=!1})}})}var a,i,s=t.$on("$routeChangeStart",function(){var e=t.transcludeScope[t.as||t.rel];e instanceof n&&!t.noResetOnRouteChange&&e.reset(),s()});t.$watch("resource",r),t.$watch("update",r),t.$watch("labelPrefix",function(){t.labelPrefix=t.labelPrefix&&""!==t.labelPrefix?t.labelPrefix:"general.item"}),t.labelPrefix=""}]}}]),angular.module("uebb.hateoas").directive("hateoasList",function(){"use strict";return{restrict:"EA",templateUrl:"uebb_hateoas_templates/hateoas-list.html",transclude:!0,replace:!1,scope:{resource:"=?",rel:"@",as:"@",resourceAs:"@",limit:"@",bare:"=?",order:"@",where:"=?",filter:"=?",page:"@",search:"=?",autoUpdate:"=?",update:"=?",orderFields:"=?",orderField:"@",orderDirection:"@",labelPrefix:"@",disableSpinner:"=?",disableMessages:"=?",disablePagination:"=?","if":"=",onLoad:"&",ignoreCache:"&"},link:function(e,t,n,r,a){e.transcludeScope=e.$parent.$new(),a(e.transcludeScope,function(n){e.bare?(t.find(".transclude-bare").replaceWith(n),n.find(".pagination").replaceWith(t.find(".hateoas-pagination")),n.find(".orderFields").replaceWith(t.find(".orderFields")),n.find(".response").replaceWith(t.find(".response")),t.find(".hateoas-list").remove()):t.find(".transclude-content").append(n)})},controller:["$scope","$timeout","HateoasResource","Promise",function(e,t,n,r){e.page=e.page||1;var a=null,i="",s=function(){if(e["if"]!==!1){e.transcludeScope.error=null;var s=e.update||!!e.ignoreCache(),l=e.update;e.update=!1,r.resolve(e.resource).then(function(r){if(r instanceof n){var o=[];e.order&&""!==e.order&&o.push(e.order),e.orderField&&e.orderDirection&&o.push(e.orderField+" "+e.orderDirection),e.limit=parseInt(e.limit,10),isNaN(e.limit)&&(e.limit=10),e.page=parseInt(e.page,10),isNaN(e.page)&&(e.page=1);var c={search:e.search||"",limit:e.limit,order:o.join(","),where:e.where||"",filter:e.filter,page:e.page},u=JSON.stringify(c);if(u===i&&a&&!l)return;i=u,a&&t.cancel(a),e.promise&&e.promise.isPending()&&e.promise.cancel(),a=t(function(){e.transcludeScope.error=null,e.promise=r.getLink(e.rel,c,s).then(function(t){var n={};e.resourceAs&&(e.transcludeScope[e.resourceAs]=n[e.resourceAs]=t),n[e.as||e.rel]=t.items,e.pages=t.pages,e.page=""+t.page,e.result=t,e.onLoad(n)}.bind(this),function(t){e.transcludeScope.error=t}.bind(this))}.bind(this),50)}}.bind(this))}}.bind(this);e.$watch("if",s),e.$watch("page",s),e.$watch("limit",s),e.$watch("order",s),e.$watch("orderField",s),e.$watch("orderDirection",s),e.$watch("resource",s),e.$watch("result.items",function(t){e.transcludeScope[e.as||e.rel]=t}.bind(this),!0),e.$watch("labelPrefix",function(){e.labelPrefix=e.labelPrefix&&""!==e.labelPrefix?e.labelPrefix:"general.list"}),e.labelPrefix="",e.setOrder=function(t,n){e.orderField=t,e.orderDirection=n},e.$watch("orderFields",function(){e.orderFields&&e.orderFields.length&&("DESC"!==e.orderDirection&&(e.orderDirection="ASC"),e.orderField=-1===e.orderFields.indexOf(e.orderField)?e.orderFields[0]:e.orderField)}),e.$watch("update",function(e){e&&s()})}]}}),angular.module("uebb.hateoas").directive("hateoasSelectList",function(){"use strict";return{restrict:"EA",scope:{srcResource:"=",srcRel:"@",resource:"=",srcFilter:"=?",orderField:"@",orderDirection:"@",rel:"@",itemLabel:"@",labelPrefix:"@",removed:"=?",added:"=?",updateSelected:"=?",updateAvailable:"=?",disabled:"=?"},templateUrl:"uebb_hateoas_templates/hateoasSelectList.html",link:function(e,t){e.$watch("disabled",function(e){t.css(e?{"pointer-events":"none"}:{"pointer-events":"auto"})})},controller:["$scope","debounce","HateoasResource",function(e,t,n){e.removed=e.removed||[],e.added=e.added||[],e.itemLabel=e.itemLabel||"item.name",e.labelPrefix=e.labelPrefix||"general.select_list",e.indexOf=function(e,t){if(!(Array.isArray(t)&&e instanceof n))return-1;var r;for(r=0;r<t.length;r++)if(t[r].getHref("self")===e.getHref("self"))return r;return-1},e.inArray=function(t,n){return-1!==e.indexOf(t,n)},e.add=function(t){e.inArray(t,e.added)||e.added.push(t)},e.remove=function(t){e.inArray(t,e.removed)||e.removed.push(t)},e.undoAdd=function(t){e.added.splice(e.indexOf(t,e.added),1)},e.undoRemove=function(t){e.removed.splice(e.indexOf(t,e.removed),1)},e.$watch("searchSelected",t(function(){e.updateSelected=!0},100)),e.$watch("searchAvailable",t(function(){e.updateAvailable=!0},100))}]}}),angular.module("uebb.hateoas").factory("hateoasUtil",["Promise",function(){var e={embeddedProperty:"_embedded",linksProperty:"_links",copy:function(e,t){t=t||{};var n;for(n in e)e.hasOwnProperty(n)&&"$"!==n.charAt(0)&&"$"!==n.charAt(1)&&(t[n]=e[n]);return t},flatten:function(e){function t(e,r){var a,i,s,l=!0;if(e instanceof File||Object(e)!==e)n[r]=e;else if(Array.isArray(e)){for(a=0,i=e.length;i>a;a++)t(e[a],r?r+"[]":""+a);0===i&&(n[r]=[])}else{for(s in e)e.hasOwnProperty(s)&&(l=!1,t(e[s],r?r+"["+s+"]":s));l&&(n[r]={})}}if(!e||angular.isString(e)||angular.isNumber(e))return e;var n={};return t(e,""),n},addParamsToUrl:function(t,n){return n&&(n=e.flatten(n),t=new URI(t),angular.forEach(n,function(e,r){n.hasOwnProperty(r)&&(t.removeSearch(r),t.addSearch(r,e))}),t=t.toString()),t},convertJsonToFormData:function(t){var n=new FormData;return t=e.flatten(t),Object.keys(t).forEach(function(e){n.append(e,t[e])}),n},normalizeUrl:function(e){var t=new URI(e),n=URI.parseQuery(t.query()),r={};return angular.forEach(Object.keys(n).sort(),function(e){(n[e]||0===n[e]||n[e]===!1)&&(r[e]=n[e])}),t.query(URI.buildQuery(r)),t.normalize(),t.toString()},getLinks:function(t){function n(e,t){for(var n=0;n<t.length;n++)if(t[n].href===e.href)return!0;return!1}var r=angular.copy(t[e.linksProperty])||{};return angular.forEach(Object.keys(t[e.embeddedProperty]||{}),function(a){var i=r[a],s=t[e.embeddedProperty][a];Array.isArray(s)?(r[a]=[],Array.isArray(i)?angular.forEach(function(e){r[a].push(e)}):i&&r[a].push(i),angular.forEach(s,function(t){n(t[e.linksProperty].self,r[a])||r[a].push(t[e.linksProperty].self)})):i?Array.isArray(i)?n(s[e.linksProperty].self,i)||r[a].push(s[e.linksProperty].self):i.href!==s[e.linksProperty].self.href&&(r[a]=[s[e.linksProperty].self,i]):r[a]=s[e.linksProperty].self}),r},getProperties:function(t){var n=angular.copy(t);return delete n[e.linksProperty],delete n[e.embeddedProperty],n},getNormalizedData:function(t){var n=e.getProperties(t);return n[e.linksProperty]=e.getLinks(t),n},isVirtual:function(e){return isNaN(parseInt(e.href.split("/").pop(),10))},isNotVirtual:function(t){return!e.isVirtual(t)},removeVirtualLinks:function(t){return Object.keys(t[e.linksProperty]).forEach(function(n){var r=t[e.linksProperty][n];angular.isArray(r)?t[e.linksProperty][n]=r.filter(e.isNotVirtual):t[e.linksProperty][n]&&e.isVirtual(t[e.linksProperty][n])&&delete t[e.linksProperty][n]}),t},mergeLink:function(e,t){if(t&&t.length){var n=new URI(e);
return n.resource(n.resource()+"/"+t).toString()}return e}};return e}]),angular.module("uebb.hateoas").factory("Promise",["$rootScope",function(e){return window.Promise.setScheduler(function(t){e.$evalAsync(t)}),window.Promise}]),angular.module("uebb.hateoas").directive("selectFile",["$timeout","HateoasResource",function(e,t){return{templateUrl:"uebb_hateoas_templates/select-file.html",restrict:"E",scope:{linkRel:"@",linkResource:"=?",resource:"=",uploadProperty:"=?",multiple:"=?",files:"=?",mimeTypes:"=?",upload:"=?",max:"=?",maxFilesize:"@",errors:"=?",updateExisting:"=?",errorPrefix:"@",label:"@"},link:function(n,r){n.data={updateExisting:!1},n.uploadProperty=n.uploadProperty||"upload",n.files=n.files||[],r.find("input[type=file]").on("change",function(r){e(function(){for(var e,a=0;a<r.target.files.length&&(!n.max||a<n.max);a++)e=n.resource||new t,e[n.uploadProperty||"upload"]=r.target.files.item(a),n.linkResource&&n.linkRel&&!e.hasLink(n.linkRel,n.linkResource)&&e.setLink(n.linkRel,n.linkResource),n.files.push(e);r.target.value=""})}),n.$watch("label",function(e){e&&""!==e||(n.label="general.choose_file")}),n.$watch("files.length",function(e){r.find("input[type=file]").prop("disabled",n.multiple?n.max&&e>=n.max:e>=1)}),n.$watch("multiple",function(e){r.find("input[type=file]").prop("multiple",!!e),e&&"general.choose_file"===n.label&&(n.label="general.choose_files"),e||"general.choose_files"!==n.label||(n.label="general.choose_file")}),n.$watch("updateExisting",function(e){n.data.updateExisting=e}),n.$watch("data.updateExisting",function(e){n.updateExisting=e}),n.getFileErrors=function(e){var t=null;return angular.isArray(n.errors)&&angular.forEach(n.errors,function(n){n.item===e&&(t=n.errors)}),t}}}}]),angular.module("uebb.hateoas").directive("selectHateoas",["$timeout",function(e){return{restrict:"EA",scope:{url:"=?",multiple:"=",label:"@",placeholder:"@",selected:"=?",disabled:"=",preselectedIds:"=?",onAdd:"&",onRemove:"&",rel:"@",resource:"=",srcResource:"=?",srcRel:"@",created:"=?",createFactory:"&",removed:"=?",limit:"=",where:"=",order:"=",clearButton:"="},replace:!0,templateUrl:"uebb_hateoas_templates/select-hateoas.html",link:function(t,n){function r(){t.disabled||e(function(){t.active=t.multiple===!0||t.selected.length<t.multiple||!t.multiple,t.showDropdown=t.active,t.focus()})}function a(r){return e(function(){$.contains(n[0],r.target)||(t.showDropdown=!1,t.active=!1,$(document).off("mousedown",a))}),!0}t.focus=function(){e(function(){n.find("input.search").focus()}),$(document).on("mousedown",a)},n.on("mouseenter",".chosen-results li",function(){$(this).addClass("highlighted")}),n.on("mouseleave",".chosen-results li",function(){$(this).removeClass("highlighted")}),n.on("keydown",function(n){13===n.keyCode?(n.preventDefault(),t.selectWithEnter(),e(function(){r()},200)):40===n.keyCode?(n.preventDefault(),t.preSelectNext()):38===n.keyCode&&(n.preventDefault(),t.preSelectPrev())}),n.on("click",".chosen-choices, .chosen-single",function(){r()})},controller:["$scope","HateoasResource","HateoasCollection","$timeout","Promise",function(e,t,n,r,a){function i(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t.id)return n;return-1}e.add=function(n){if(e.multiple){if(e.multiple!==!0&&e.selected.length>=e.multiple)return;e.remove(n)}else angular.forEach(e.selected,function(t){e.remove(t)});e.selected.push(n),e.onAdd({item:n}),e.resource instanceof t&&e.rel&&-1===i(e.existing,n)&&e.resource.setLink(e.rel,n,!e.multiple),e.search="",e.showDropdown=!1,e.multiple===!0||e.selected.length<e.multiple?e.focus():e.active=!1,e.query()},e.selected||(e.selected=[]),e.removed||(e.removed=[]),e.existing=[],e.$watch("resource",function(){a.resolve(e.resource).then(function(r){if(r instanceof t){if(!r.hasHref(e.rel))return;var a;e.multiple&&(a={limit:e.multiple===!0?0:e.multiple}),e.resource.getLink(e.rel,a).then(function(t){e.selected.length=0,e.existing.length=0,t instanceof n?(e.selected.push.apply(e.selected,t.items),e.existing.push.apply(e.existing,t.items)):(e.selected.push(t),e.existing.push(t))},function(){})}})}),e.search="",e.active=!1,e.displayCreate=!1,e.remove=function(t){t.hasHref("self")?angular.forEach(e.selected,function(n){t.getHref("self")===n.getHref("self")&&(e.selected.splice(e.selected.indexOf(n),1),e.onRemove({item:n}),e.resource&&e.rel&&e.resource.removeLink(e.rel,t,-1!==i(e.existing,t)))}):e.selected.splice(e.selected.indexOf(t),1),e.created&&e.created.splice(e.created.indexOf(t),1),e.query()},e.isNotSelected=function(t){return!e.isSelected(t)},e.isSelected=function(t){for(var n=0;n<e.selected.length;n++)if(t.getHref("self")===e.selected[n].getHref("self"))return!0;return!1},e.page=1,e.changePage=function(t){1>t?t=1:t>e.request.value().pages&&(t=e.request.value().pages),e.page=t,e.query()};var s=null;e.query=function(){e.request=null,e.displayCreate=!1,s&&r.cancel(s);var n=e.selected.map(function(e){return"id != "+e.id});e.where&&n.unshift(e.where);var a={page:e.page||1,limit:e.limit||10,search:e.search||"",order:e.order||void 0,where:n.join(" AND ")};s=r(function(){e.request=t.get(e.url,a).then(function(t){angular.forEach(t.items,function(e){e.selected=!1});for(var n=0;n<t.items.length;n++)if(e.isNotSelected(t.items[n])){e.preSelectedIndex=n,t.items[n].selected=!0;break}if(e.search&&e.created){var r=!1;angular.forEach(t.items,function(t){t===e.search&&(r=!0)}),e.displayCreate=!r}return t}),e.selectedIndex=0},250)},e.create=function(){a.resolve(e.createFactory({search:e.search})).then(function(t){e.created.push(t),e.selected.push(t),e.search="",e.showDropdown=!1,r(e.query,100)})},e.type=function(t){8===t.keyCode&&""===e.search&&e.selected.length&&e.remove(e.selected[e.selected.length-1])},e.$watch("url",function(){e.url&&e.query()}),e.$watch("srcResource",function(n){a.resolve(n).then(function(n){n instanceof t&&e.srcRel&&(e.url=n.getHref(e.srcRel)),!e.resource&&angular.isArray(e.preselectedIds)&&e.preselectedIds.length&&(e.multiple?angular.isNumber(e.multiple)&&e.preselectedIds.length>e.multiple&&(e.preselectedIds.length=e.multiple):e.preselectedIds.length=1,t.get(e.url,{limit:0,where:e.preselectedIds.map(function(e){return"id = "+e}).join(" OR ")}).then(function(t){e.selected.length=0,e.selected.push.apply(e.selected,t.items)}))})}),e.preSelectedIndex=null,e.preSelectedItem=null,e.$watch("preSelectedIndex",function(t,n){angular.isUndefined(t)||null===t?e.preSelectedItem=null:angular.isDefined(e.request.value().items[t])?(angular.isDefined(e.request.value().items[n])&&(e.request.value().items[n].selected=!1),e.preSelectedItem=e.request.value().items[t],e.preSelectedItem.selected=!0):e.preSelectedIndex=null}),e.preSelectNext=function(){if(e.request&&!e.request.isPending()){var t=e.preSelectedIndex+1;t>=e.request.value().items.length-1&&(t=e.request.value().items.length-1);for(var n=!1,r=t;r<e.request.value().items.length;r++)if(e.isNotSelected(e.request.value().items[r])){t=r,n=!0;break}n||(t=null),e.$apply(function(){e.preSelectedIndex=t})}},e.preSelectPrev=function(){if(e.request&&!e.request.isPending()){var t=e.preSelectedIndex-1;0>t&&(t=0);for(var n=!1,r=t;r>=0;r--)if(e.isNotSelected(e.request.value().items[r])){t=r,n=!0;break}n||(t=null),e.$apply(function(){e.preSelectedIndex=t})}},e.selectWithEnter=function(){e.request&&!e.request.isPending()&&(angular.isDefined(e.request.value().items[e.preSelectedIndex])?e.add(e.request.value().items[e.preSelectedIndex]):e.create())}}]}}]);